var __awaiter=this&&this.__awaiter||function(t,e,a,n){function i(t){return t instanceof a?t:new a((function(e){e(t)}))}return new(a||(a=Promise))((function(a,o){function r(t){try{c(n.next(t))}catch(e){o(e)}}function s(t){try{c(n["throw"](t))}catch(e){o(e)}}function c(t){t.done?a(t.value):i(t.value).then(r,s)}c((n=n.apply(t,e||[])).next())}))};var __generator=this&&this.__generator||function(t,e){var a={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,r;return r={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,i&&(o=r[0]&2?i["return"]:r[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;if(i=0,o)r=[r[0]&2,o.value];switch(r[0]){case 0:case 1:o=r;break;case 4:a.label++;return{value:r[1],done:false};case 5:a.label++;i=r[1];r=[0];continue;case 7:r=a.ops.pop();a.trys.pop();continue;default:if(!(o=a.trys,o=o.length>0&&o[o.length-1])&&(r[0]===6||r[0]===2)){a=0;continue}if(r[0]===3&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(r[0]===6&&a.label<o[1]){a.label=o[1];o=r;break}if(o&&a.label<o[2]){a.label=o[2];a.ops.push(r);break}if(o[2])a.ops.pop();a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s];i=0}finally{n=o=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:true}}};System.register(["./p-a2936c11.system.js","./p-632ac043.system.js","./p-2f000fd9.system.js","./p-d3e779e2.system.js","./p-e8fb2e42.system.js","./p-b9aef7e7.system.js","./p-3f376874.system.js","./p-1284c5fd.system.js","./p-b0e469e2.system.js","./p-6b5506eb.system.js","./p-2dcd7b89.system.js"],(function(t){"use strict";var e,a,n,i,o,r,s,c,l,h,p,u,f,d;return{setters:[function(t){e=t.r;a=t.j;n=t.h;i=t.H;o=t.e},function(){},function(){},function(t){r=t.i;s=t.k;c=t.a;l=t.s;h=t.g;p=t.c;u=t.h;f=t.d},function(){},function(){},function(){},function(){},function(){},function(){},function(t){d=t.a}],execute:function(){var g=t("cy_draggable",function(){function t(t){e(this,t);this.canModify=false;this.isChoose=false;this.scale=1;this.isDomDrag=false;this.isHover=false;this.cyScale=a(this,"cyScale",7);this.cyDrag=a(this,"cyDrag",7);this.choose=a(this,"choose",7)}t.prototype.watchHandler=function(t){this.setZindexByChoose(t)};t.prototype.componentDidLoad=function(){this.setZindexByChoose(this.isChoose)};t.prototype.setZindexByChoose=function(t){this.el.style.zIndex=t?"999":""};t.prototype.onDragScaleDown=function(t,e,a,n){var i=this;t.stopPropagation();this.isDomDrag=true;var o=this.el.style.transform.match(/\-?[0-9]+\.?[0-9]*/g);var r=Math.floor(t.clientX-(o&&parseInt(o[0])*this.scale||0)-a*this.scale);var s=Math.floor(t.clientY-(o&&parseInt(o[1])*this.scale||0)-n*this.scale);var c=this.el.clientWidth;var l=this.el.clientHeight;var h=o[0];var p=o[1];document.onpointermove=function(t){t.stopPropagation();i.onDragScaleMove(t,e,r,s,c,l,parseInt(h),parseInt(p))};document.onpointerup=function(){i.isDomDrag=false;document.onpointermove=null;document.onpointerup=null;var t=i.el.style.transform.match(/\-?[0-9]+\.?[0-9]*/g);i.cyScale.emit({w:parseInt(i.el.clientWidth+""),h:parseInt(i.el.clientHeight+""),x:parseInt(t[0]),y:parseInt(t[1])})}};t.prototype.onDragScaleMove=function(t,e,a,n,i,o,r,s){switch(e){case"righttop":this.el.style.width=Math.floor((t.clientX-a)/this.scale)-r+"px";var c=Math.floor((o+s)*this.scale+n-t.clientY)/this.scale;this.el.style.height=c>0?c+"px":0+"px";this.el.style.transform=this.el.style.transform.replace(/translate(.*px, .*px)/g,"translate("+r+"px, "+(t.clientY-n)/this.scale+"px");break;case"lefttop":var l=Math.floor((i+r)*this.scale+a-t.clientX)/this.scale;this.el.style.width=l>0?l+"px":0+"px";var c=Math.floor((o+s)*this.scale+n-t.clientY)/this.scale;this.el.style.height=c>0?c+"px":0+"px";this.el.style.transform=this.el.style.transform.replace(/translate(.*px, .*px)/g,"translate("+(t.clientX-a)/this.scale+"px, "+(t.clientY-n)/this.scale+"px");break;case"leftbottom":var l=Math.floor((i+r)*this.scale+a-t.clientX)/this.scale;this.el.style.width=l>0?l+"px":0+"px";this.el.style.height=Math.floor((t.clientY-n)/this.scale)-s+"px";this.el.style.transform=this.el.style.transform.replace(/translate(.*px, .*px)/g,"translate("+(t.clientX-a)/this.scale+"px, "+s+"px");break;case"rightbottom":this.el.style.width=Math.floor((t.clientX-a)/this.scale)-r+"px";this.el.style.height=Math.floor((t.clientY-n)/this.scale)-s+"px";break;case"top":var c=Math.floor((o+s)*this.scale+n-t.clientY)/this.scale;this.el.style.height=c>0?c+"px":0+"px";this.el.style.transform=this.el.style.transform.replace(/translate(.*px, .*px)/g,"translate("+r+"px, "+(t.clientY-n)/this.scale+"px");break;case"left":var l=Math.floor((i+r)*this.scale+a-t.clientX)/this.scale;this.el.style.width=l>0?l+"px":0+"px";this.el.style.transform=this.el.style.transform.replace(/translate(.*px, .*px)/g,"translate("+(t.clientX-a)/this.scale+"px, "+s+"px");break;case"bottom":this.el.style.height=Math.floor((t.clientY-n)/this.scale)-s+"px";break;case"right":this.el.style.width=Math.floor((t.clientX-a)/this.scale)-r+"px";break;default:break}};t.prototype.onDragBoxDown=function(t){var e=this;t.preventDefault();t.stopPropagation();this.isDomDrag=true;var a=t.clientX;var n=t.clientY;var i=this.el.style.transform.match(/\-?[0-9]+\.?[0-9]*/g);var o=a-(i&&parseInt(i[0])*this.scale||0);var r=n-(i&&parseInt(i[1])*this.scale||0);document.onpointermove=function(t){t.stopPropagation();e.onDragBoxMove(t,o,r)};document.onpointerup=function(){e.isDomDrag=false;document.onpointermove=null;document.onpointerup=null;var t=e.el.style.transform.match(/\-?[0-9]+\.?[0-9]*/g);e.cyDrag.emit({w:parseInt(e.el.clientWidth+""),h:parseInt(e.el.clientHeight+""),x:parseInt(t[0]),y:parseInt(t[1])})}};t.prototype.onDragBoxMove=function(t,e,a){var n=t.clientX;var i=t.clientY;var o=(n-e)/this.scale,r=(i-a)/this.scale;this.el.style.transform=this.el.style.transform.replace(/translate(.*px, .*px)/g,"translate("+o+"px, "+r+"px")};t.prototype.handleDomChoose=function(t){t.preventDefault();t.stopPropagation();this.choose.emit()};t.prototype.render=function(){var t=this;return n(i,{style:{"touch-action":this.isChoose?"none":"auto",border:this.isHover&&this.canModify&&!this.isChoose&&"1px solid var(--border-color)"||""},onMouseEnter:function(){t.isHover=true},onMouseLeave:function(){t.isHover=false},onClick:function(e){t.handleDomChoose(e)},onPointerDown:function(e){t.canModify&&t.isChoose&&t.onDragBoxDown(e)}},n("div",{class:this.canModify&&this.isChoose||this.isDomDrag?"draggable_over":"draggable_over hiddlen"},n("i",{style:{transform:"scale("+(1/this.scale).toFixed(4)+", "+(1/this.scale).toFixed(4)+")"},class:"drag_tag drag_tag_righttop",onPointerDown:function(e){t.onDragScaleDown(e,"righttop",t.el.clientWidth,0)}}),n("i",{style:{transform:"scale("+(1/this.scale).toFixed(4)+", "+(1/this.scale).toFixed(4)+")"},class:"drag_tag drag_tag_rightbottom",onPointerDown:function(e){t.onDragScaleDown(e,"rightbottom",t.el.clientWidth,t.el.clientHeight)}}),n("i",{style:{transform:"scale("+(1/this.scale).toFixed(4)+", "+(1/this.scale).toFixed(4)+")"},class:"drag_tag drag_tag_leftbottom",onPointerDown:function(e){t.onDragScaleDown(e,"leftbottom",0,t.el.clientHeight)}}),n("i",{style:{transform:"scale("+(1/this.scale).toFixed(4)+", "+(1/this.scale).toFixed(4)+")"},class:"drag_tag drag_tag_lefttop",onPointerDown:function(e){t.onDragScaleDown(e,"lefttop",0,0)}}),n("i",{style:{transform:"scale("+(1/this.scale).toFixed(4)+", "+(1/this.scale).toFixed(4)+")"},class:"drag_tag drag_tag_right",onPointerDown:function(e){t.onDragScaleDown(e,"right",t.el.clientWidth,Math.floor(t.el.clientHeight*.5))}}),n("i",{style:{transform:"scale("+(1/this.scale).toFixed(4)+", "+(1/this.scale).toFixed(4)+")"},class:"drag_tag drag_tag_bottom",onPointerDown:function(e){t.onDragScaleDown(e,"bottom",Math.floor(t.el.clientWidth*.5),t.el.clientHeight)}}),n("i",{style:{transform:"scale("+(1/this.scale).toFixed(4)+", "+(1/this.scale).toFixed(4)+")"},class:"drag_tag drag_tag_left",onPointerDown:function(e){t.onDragScaleDown(e,"left",0,Math.floor(.5*t.el.clientHeight))}}),n("i",{style:{transform:"scale("+(1/this.scale).toFixed(4)+", "+(1/this.scale).toFixed(4)+")"},class:"drag_tag drag_tag_top",onPointerDown:function(e){t.onDragScaleDown(e,"top",Math.floor(.5*t.el.clientWidth),0)}})),n("div",{class:"container"},n("slot",null)))};Object.defineProperty(t.prototype,"el",{get:function(){return o(this)},enumerable:true,configurable:true});Object.defineProperty(t,"watchers",{get:function(){return{isChoose:["watchHandler"]}},enumerable:true,configurable:true});Object.defineProperty(t,"style",{get:function(){return":host{--color:#fff;--background:transparent;--choose-background:rgba(27,70,117,0.5);--padding:0px;--overflow:hidden;--opacity:1;--point-size:40px;--border-width:2px;padding:var(--padding);padding:0!important;margin:0!important;display:block;position:relative;will-change:transform;-webkit-transform-origin:50% 50%;transform-origin:50% 50%}*,:host{-webkit-box-sizing:border-box;box-sizing:border-box}.container{width:100%;height:100%;color:var(--color);overflow:var(--overflow);opacity:var(--opacity)}.draggable_over{position:absolute;top:0;bottom:0;left:0;right:0;cursor:-webkit-grab;cursor:grab;z-index:999;border-width:var(--border-width);border-style:solid;border-color:var(--border-color);background:var(--choose-background)}.hiddlen{visibility:hidden;-webkit-box-shadow:none;box-shadow:none}.drag_tag{position:absolute;width:var(--point-size);height:var(--point-size);z-index:999;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;-ms-touch-action:none;touch-action:none}.drag_tag:before{content:\"\";position:relative;background:var(--color,#fff);width:calc(.3 * var(--point-size));height:calc(.3 * var(--point-size));border-radius:50%}.drag_tag_right{top:calc(50% - calc(.5 * var(--point-size)));right:calc(-1 * calc(.5 * var(--point-size)));cursor:move}.drag_tag_bottom{right:calc(50% - calc(.5 * var(--point-size)))}.drag_tag_bottom,.drag_tag_rightbottom{bottom:calc(-1 * calc(.5 * var(--point-size)));cursor:move}.drag_tag_rightbottom{right:calc(-1 * calc(.5 * var(--point-size)))}.drag_tag_righttop{right:0;right:calc(-1 * calc(.5 * var(--point-size)));top:calc(-1 * calc(.5 * var(--point-size)));cursor:move}.drag_tag_leftbottom{left:calc(-1 * calc(.5 * var(--point-size)));bottom:calc(-1 * calc(.5 * var(--point-size)));cursor:move}.drag_tag_left{top:calc(50% - calc(.5* var(--point-size)));left:calc(-1 * calc(.5* var(--point-size)));cursor:move}.drag_tag_lefttop{left:calc(-1 * calc(.5 * var(--point-size)));top:calc(-1 * calc(.5 * var(--point-size)));cursor:move}.drag_tag_top{top:calc(-1 * calc(.5* var(--point-size)));left:calc(50% - calc(.5* var(--point-size)));cursor:move}"},enumerable:true,configurable:true});return t}());var y=t("datascreen_canvas",function(){function t(t){e(this,t);this.scale=100;this.canModify=true;this.chooseComId="";this.comOptionList=[];this.popover=a(this,"popover",7);this.canvasChange=a(this,"canvasChange",7)}t.prototype.watchHandler=function(t){this.upDateElSize(this.canvasOption,t)};t.prototype.componentWillLoad=function(){r(this.el);this.canvasOption=s();this.mapComDatasToState(c())};t.prototype.upDateElSize=function(t,e){this.el.style.width=Math.floor(e/100*parseInt(t.w))+"px";this.el.style.height=Math.floor(e/100*parseInt(t.h))+"px"};t.prototype.setDataScreen=function(t,e,a){if(a===void 0){a=true}return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(n){l(t,e,a);return[2]}))}))};t.prototype.getDataScreen=function(t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,h(t)];case 1:return[2,e.sent()]}}))}))};t.prototype.getCanvasSize=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){if(this.canvasOption){return[2,{w:parseInt(this.canvasOption.w),h:parseInt(this.canvasOption.h)}]}else{return[2,null]}return[2]}))}))};t.prototype.mapComDatasToState=function(t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){this.comOptionList=t;return[2]}))}))};t.prototype.chooseComponentById=function(t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:if(!(t!==this.chooseComId))return[3,2];this.chooseComId=t;return[4,p(t)];case 1:e.sent();e.label=2;case 2:return[2]}}))}))};t.prototype.setCanvasConfig=function(t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){this.canvasOption=Object.assign({},t);this.canvasChange.emit();this.upDateElSize(this.canvasOption,this.scale);return[2]}))}))};t.prototype.handleDraggableDrag=function(t,e){if(e.data.view.x!==t.detail.x||e.data.view.y!==t.detail.y){e.data.view.x=t.detail.x+"";e.data.view.y=t.detail.y+"";u(e,true,true)}};t.prototype.handleDraggableScale=function(t,e){if(e.data.view.w!==t.detail.w||e.data.view.h!==t.detail.h){e.data.view.w=t.detail.w+"";e.data.view.h=t.detail.h+"";e.data.view.x=t.detail.x+"";e.data.view.y=t.detail.y+"";u(e,true,true)}};t.prototype.popoverContextMenu=function(t,e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(a){switch(a.label){case 0:t.preventDefault();t.stopPropagation();return[4,this.chooseComponentById(e)];case 1:a.sent();this.popover.emit({component:"popover-draggable-contextmenu",cssClass:"contextmenu-popover",event:t,showBackdrop:false,componentProps:{comId:e}});return[2]}}))}))};t.prototype.render=function(){var t=this;if(this.canvasOption){return n("div",{class:"drag_container",style:{transform:"scale("+this.scale/100+")",width:this.canvasOption.w+"px",height:this.canvasOption.h+"px","background-color":this.canvasOption.bgc+"","background-image":this.canvasOption.bgi?"url("+this.canvasOption.bgi+")":"",overflow:this.canModify?"inherit":"hidden"}},this.comOptionList.map((function(e){return n("cy-draggable",{key:e.id,onContextMenu:function(a){t.canModify&&t.popoverContextMenu(a,e.id)},isChoose:t.chooseComId==e.id,canModify:t.canModify,scale:Math.round(t.scale)/100,onCyDrag:function(a){t.handleDraggableDrag(a,e)},onCyScale:function(a){t.handleDraggableScale(a,e)},onChoose:function(){t.chooseComponentById(e.id)},style:{position:"absolute",transform:"translate("+e.data.view.x+"px, "+e.data.view.y+"px) rotate("+e.data.view.deg+"deg)",width:e.data.view.w+"px",height:e.data.view.h+"px","--opacity":e.data.view.opacity+""}},n("draggable-adapter",{key:e.id,comOptionData:e,canModify:t.canModify}))})))}else{return null}};Object.defineProperty(t.prototype,"el",{get:function(){return o(this)},enumerable:true,configurable:true});Object.defineProperty(t,"watchers",{get:function(){return{scale:["watchHandler"]}},enumerable:true,configurable:true});Object.defineProperty(t,"style",{get:function(){return"datascreen-canvas{--box-shadow:var(--ion-background-shade,#1c1c1c) 0 0 30px 0;--background:var(--datascreen-canvas-bg,#282830);display:inline-block;-webkit-transform-origin:0 0;transform-origin:0 0}datascreen-canvas .drag_container{position:absolute;width:100%;height:100%;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transition:all .5s ease-in;transition:all .5s ease-in;background-size:cover,contain;background-position:50%,100% 100%;background-repeat:no-repeat,no-repeat;-webkit-box-shadow:rgba(0,0,0,.5) 0 0 30px 0;box-shadow:0 0 30px 0 rgba(0,0,0,.5)}"},enumerable:true,configurable:true});return t}());var m=t("datascreen_canvas_content",function(){function t(t){e(this,t);this.minCanvasScale=15;this.maxCanvasSCale=300;this.padding=0;this.canvasScaleChange=a(this,"canvasScaleChange",7)}t.prototype.componentDidLoad=function(){this.resizeSCale()};t.prototype.customEventHandler=function(){this.resizeSCale()};t.prototype.resizeSCale=function(){return __awaiter(this,void 0,void 0,(function(){var t,e,a,n,i;return __generator(this,(function(o){switch(o.label){case 0:t=this.el.querySelector("datascreen-canvas");e=this.el.clientWidth-2*this.padding;a=this.el.clientHeight-2*this.padding;return[4,t.getCanvasSize()];case 1:i=o.sent();if(t&&i){if(i){if(i.w/i.h>e/a){n=e/i.w*100}else{n=a/i.h*100}n=n>this.minCanvasScale?n:this.minCanvasScale;n=n>this.maxCanvasSCale?this.maxCanvasSCale:n;n=Math.ceil(n*100)/100;this.canvasScaleChange.emit(n);t.scale=n}}return[2]}}))}))};t.prototype.render=function(){return n(i,{style:{padding:this.padding+"px"}},n("slot",null))};Object.defineProperty(t.prototype,"el",{get:function(){return o(this)},enumerable:true,configurable:true});Object.defineProperty(t,"style",{get:function(){return"datascreen-canvas-content{width:100%;height:100%;display:block;overflow:auto;position:relative;-webkit-box-sizing:border-box;box-sizing:border-box}"},enumerable:true,configurable:true});return t}());var v=t("draggable_adapter",function(){function t(t){e(this,t);this.canModify=false;this.alert=a(this,"alert",7);this.toast=a(this,"toast",7)}t.prototype.watchHandler=function(t,e){if(JSON.stringify(t.data.api_data)!==JSON.stringify(e.data.api_data)){this.resignDataReceiver()}};t.prototype.componentWillLoad=function(){this.resignDataReceiver()};t.prototype.resignDataReceiver=function(){var t=this;this.comOptionData.data.api_data&&d(this.comOptionData.id,f({},this.comOptionData.data.api_data),(function(e){t.apiData=e}))};t.prototype.render=function(){var t=this.comOptionData.comName.split("-")[0]||"";switch(t){case"media":return n("media-adapter",{canModify:this.canModify,comData:this.comOptionData,dataSource:this.apiData});case"chart":return n("chart-adapter",{comDataView:this.comOptionData.data.view,comDataConfig:this.comOptionData.data.config,comDataApiData:this.comOptionData.data.api_data,dataSource:this.apiData});case"text":return n("text-adapter",{comData:this.comOptionData,comDataConfig:this.comOptionData.data.config,dataSource:this.apiData});case"table":return n("table-adapter",{comDataView:this.comOptionData.data.view,comDataConfig:this.comOptionData.data.config,dataSource:this.apiData});default:break}};Object.defineProperty(t,"watchers",{get:function(){return{comOptionData:["watchHandler"]}},enumerable:true,configurable:true});Object.defineProperty(t,"style",{get:function(){return""},enumerable:true,configurable:true});return t}())}}}));