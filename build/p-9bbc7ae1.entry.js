import{r as t,h as i,H as s,g as n}from"./p-09c1f8fc.js";import{c as o}from"./p-1ea257a7.js";import{c as r}from"./p-d2880d55.js";import{g as a,c as e}from"./p-06c8aa11.js";const h="open-menu",c=class{constructor(i){t(this,i),this.canMoveX=0,this.isOpen=!1,this.side="left"}connectedCallback(){this.gesture=r({el:document,direction:"x",threshold:15,canStart:this.canStart.bind(this),onWillStart:this.onWillStart.bind(this),onStart:this.onStart.bind(this),onMove:this.onMove.bind(this),onEnd:this.onEnd.bind(this)}),this.gesture.enable(!0)}disconnectedCallback(){this.gesture.destroy(),this.animation.destroy(),this.gesture=void 0}canStart(t){const i="left"===this.side?t.startX:window.innerWidth-t.startX;return!(!this.isOpen&&i>40)}onWillStart(){return this.beforeAnimation(),this.loadAnimation()}beforeAnimation(){this.el.classList.add(h)}onStart(){this.animation.progressStart(!0,this.isOpen?1:0)}onMove(t){const i=this.getAnimationStep(this.isOpen,t.deltaX);this.animation.progressStep(i)}async onEnd(t){const i=this.getAnimationStep(this.isOpen,t.deltaX,!0);let s=1;i<.5&&(s=0),this.animation.onFinish((()=>{this.afterAnimation(1===s)}),{oneTimeCallback:!0}).progressEnd(s,i)}afterAnimation(t){this.isOpen=t,this.isOpen||this.el.classList.remove(h)}getAnimationStep(t,i,s=!1){let n=t?-1*i:i;n="left"===this.side?n:-1*n;let o=e(1e-4,n/this.canMoveX,.9999);return t&&(o=1-o),s?a([0,0],[.4,0],[.6,1],[1,1],o)[0]:o}onBackDropClick(){this.close()}async open(){this._setOpen(!0)}async close(){this._setOpen(!1)}async toggle(){this.isOpen?this.close():this.open()}async _setOpen(t){this.beforeAnimation(),await this.loadAnimation(),await this.startAnimation(t),this.afterAnimation(t)}async startAnimation(t){const i=this.animation.direction(t?"normal":"reverse").onFinish((()=>{"reverse"===i.getDirection()&&i.direction("normal")}));await i.play()}async loadAnimation(){const t=this.el.shadowRoot.querySelector(".menu-container").clientWidth;t===this.canMoveX&&void 0!==this.animation||(this.canMoveX=t,this.animation&&(this.animation.destroy(),this.animation=null),this.animation=await((t,i="left")=>"left"===i?(t=>{const i=o(),s=o().addElement(t.shadowRoot.querySelector("cy-backdrop")).fromTo("opacity","0","var(--opacity)"),n=o().addElement(t.shadowRoot.querySelector(".menu-container")).fromTo("transform","translateX(-100%)","translateX(0%)");return i.addElement(t).easing("cubic-bezier(0.4,0.0,0.2,1)").duration(350).addAnimation([s,n])})(t):(t=>{const i=o(),s=o().addElement(t.shadowRoot.querySelector("cy-backdrop")).fromTo("opacity","0","var(--opacity)"),n=o().addElement(t.shadowRoot.querySelector(".menu-container")).fromTo("transform","translateX(100%)","translateX(0%)");return i.addElement(t).easing("cubic-bezier(0.4,0.0,0.2,1)").duration(350).addAnimation([s,n])})(t))(this.el,this.side),this.animation.fill("both"))}render(){return i(s,null,i("div",{class:{"menu-container":!0,"menu-right":"right"===this.side}},i("slot",null)),i("cy-backdrop",{onBackDrop:this.onBackDropClick.bind(this)}))}get el(){return n(this)}};c.style=":host{--menu-width:280px;position:absolute;top:0;left:0;right:0;bottom:0;contain:strict;z-index:1000;display:none;user-select:none}:host(.open-menu){display:block}.menu-container{width:var(--menu-width);height:100%;contain:strict;z-index:1;position:relative;will-change:transform;background:var(--cy-toolbar-background);box-shadow:2px 0 12px rgba(0, 0, 0, 0.15);border-right:1px solid var(--cy-border-color)}.menu-right{float:right;border-left:none;border-left:1px solid var(--cy-border-color);box-shadow:-2px 0 12px rgba(0, 0, 0, 0.15)}";export{c as cy_menu}